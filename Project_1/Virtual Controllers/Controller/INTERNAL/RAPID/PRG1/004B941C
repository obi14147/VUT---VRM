MODULE Module1
    CONST robtarget Target_10:=[[450.999987805,0.004,610.099],[-0.000000022,0,1,0],[0,0,0,0],[9E+09,9E+09,9E+09,9E+09,9E+09,9E+09]];
    CONST robtarget Target_20_2:=[[126.719422004,661.158479903,182.817520703],[-0.000000022,0,1,0],[0,0,0,0],[9E+09,9E+09,9E+09,9E+09,9E+09,9E+09]];
    CONST robtarget Target_20:=[[126.719422004,661.158479903,37.5],[-0.000000022,0,1,0],[0,0,0,0],[9E+09,9E+09,9E+09,9E+09,9E+09,9E+09]];
    CONST robtarget Target_20_2_2:=[[464.471825029,427.319706587,301.095329059],[-0.000000022,0,1,0],[0,0,0,0],[9E+09,9E+09,9E+09,9E+09,9E+09,9E+09]];
    CONST robtarget Target_30_2:=[[277.627422004,-486.606520097,300.389057938],[-0.000000022,0,1,0],[-1,-1,-1,0],[9E+09,9E+09,9E+09,9E+09,9E+09,9E+09]];
    CONST robtarget Target_30:=[[277.627422004,-486.606520097,175.506],[-0.000000022,0,1,0],[0,0,0,0],[9E+09,9E+09,9E+09,9E+09,9E+09,9E+09]];
    CONST robtarget Target_40:=[[450.999997776,0.004,610.098996275],[-0.000000026,0,1,0],[-1,-1,-1,0],[9E+09,9E+09,9E+09,9E+09,9E+09,9E+09]];
    CONST robtarget Target_50_2:=[[494.007422004,110.120479903,243.149179906],[-0.000000026,0,1,0],[0,0,0,0],[9E+09,9E+09,9E+09,9E+09,9E+09,9E+09]];
    CONST robtarget Target_50:=[[494.007422004,110.120479903,27],[-0.000000026,0,1,0],[0,0,0,0],[9E+09,9E+09,9E+09,9E+09,9E+09,9E+09]];
    CONST robtarget Target_60_2:=[[364.007422004,-486.879520097,296.377438496],[-0.000000026,0,1,0],[-1,-1,-1,0],[9E+09,9E+09,9E+09,9E+09,9E+09,9E+09]];
    CONST robtarget Target_60:=[[364.007422004,-486.879520097,166],[-0.000000026,0,1,0],[0,0,0,0],[9E+09,9E+09,9E+09,9E+09,9E+09,9E+09]];
    CONST robtarget Target_70_2:=[[494.007422004,410.120479903,208.921069694],[-0.000000026,0,1,0],[0,0,0,0],[9E+09,9E+09,9E+09,9E+09,9E+09,9E+09]];
    CONST robtarget Target_70:=[[494.007422004,410.120479903,27],[-0.000000026,0,1,0],[0,0,0,0],[9E+09,9E+09,9E+09,9E+09,9E+09,9E+09]];
    CONST robtarget Target_80_2:=[[190.007422004,-486.879520097,254.222556398],[-0.000000026,0,1,0],[-1,-1,-1,0],[9E+09,9E+09,9E+09,9E+09,9E+09,9E+09]];
    CONST robtarget Target_80:=[[190.007422004,-486.879520097,166],[-0.000000026,0,1,0],[0,0,0,0],[9E+09,9E+09,9E+09,9E+09,9E+09,9E+09]];
    CONST robtarget Target_90:=[[451.000000008,0.004,610.098996275],[-0.000000026,0,1,0],[-1,-1,-1,0],[9E+09,9E+09,9E+09,9E+09,9E+09,9E+09]];
    CONST robtarget Target_100_2:=[[406.507422004,108.732479903,260.213700633],[-0.000000026,0,1,0],[0,0,0,0],[9E+09,9E+09,9E+09,9E+09,9E+09,9E+09]];
    CONST robtarget Target_100:=[[406.507422004,108.732479903,27],[-0.000000026,0,1,0],[0,0,0,0],[9E+09,9E+09,9E+09,9E+09,9E+09,9E+09]];
    CONST robtarget Target_110_2:=[[364.007422004,-486.879520097,317.402767153],[-0.000000026,0,1,0],[-1,-1,-1,0],[9E+09,9E+09,9E+09,9E+09,9E+09,9E+09]];
    CONST robtarget Target_110:=[[364.007422004,-486.879520097,166],[-0.000000026,0,1,0],[0,0,0,0],[9E+09,9E+09,9E+09,9E+09,9E+09,9E+09]];
    CONST robtarget Target_120_2:=[[494.007422004,410.120479903,241.125441554],[-0.000000026,0,1,0],[0,0,0,0],[9E+09,9E+09,9E+09,9E+09,9E+09,9E+09]];
    CONST robtarget Target_120:=[[406.507422004,410.120479903,27.00000455],[-0.000000026,0,1,0],[0,0,0,0],[9E+09,9E+09,9E+09,9E+09,9E+09,9E+09]];
    CONST robtarget Target_130_2:=[[190.007422004,-486.879520097,321.160892308],[-0.000000026,0,1,0],[-1,-1,-1,0],[9E+09,9E+09,9E+09,9E+09,9E+09,9E+09]];
    CONST robtarget Target_130:=[[190.007422004,-486.879520097,166],[-0.000000026,0,1,0],[0,0,0,0],[9E+09,9E+09,9E+09,9E+09,9E+09,9E+09]]; 
    CONST robtarget Target_140:=[[451.000000008,0.004,610.098996275],[-0.000000026,0,1,0],[-1,-1,-1,0],[9E+09,9E+09,9E+09,9E+09,9E+09,9E+09]];
    CONST robtarget Target_150_2:=[[581.507422004,110.120479903,308.106695553],[-0.000000026,0,1,0],[0,0,0,0],[9E+09,9E+09,9E+09,9E+09,9E+09,9E+09]];
    CONST robtarget Target_150:=[[581.507422004,110.120479903,27],[-0.000000026,0,1,0],[0,0,0,0],[9E+09,9E+09,9E+09,9E+09,9E+09,9E+09]];
    CONST robtarget Target_160_2:=[[364.007422004,-486.879520097,263.437491566],[-0.000000026,0,1,0],[-1,-1,-1,0],[9E+09,9E+09,9E+09,9E+09,9E+09,9E+09]];
    CONST robtarget Target_160:=[[364.007422004,-486.879520097,166],[-0.000000026,0,1,0],[0,0,0,0],[9E+09,9E+09,9E+09,9E+09,9E+09,9E+09]];
    CONST robtarget Target_170_2:=[[581.507422004,410.120479903,297.169545642],[-0.000000026,0,1,0],[0,0,0,0],[9E+09,9E+09,9E+09,9E+09,9E+09,9E+09]];
    CONST robtarget Target_170:=[[581.507422004,410.120479903,27],[-0.000000026,0,1,0],[0,0,0,0],[9E+09,9E+09,9E+09,9E+09,9E+09,9E+09]];
    CONST robtarget Target_180_2:=[[190.007422004,-486.879520097,285.550882013],[-0.000000026,0,1,0],[-1,-1,-1,0],[9E+09,9E+09,9E+09,9E+09,9E+09,9E+09]];
    CONST robtarget Target_180:=[[190.007422004,-486.879520097,166],[-0.000000026,0,1,0],[0,0,0,0],[9E+09,9E+09,9E+09,9E+09,9E+09,9E+09]];
    
    VAR num actual_state;
    !1 - Blue, 2 - Red, 3 - Dark red
    VAR num which_object := 1;
    
    PROC main()
        TEST actual_state
        CASE 0:
            initial_position;
            actual_state := 1;
        CASE 1:
            Path_1;
            actual_state := 2;
        CASE 2:
            IF which_object = 1 THEN
                Path_Blue_Objects;
            ELSEIF which_object = 1 THEN
            ELSE
                Path_Red_Objects;
            ENDIF
            actual_state := 3;
        CASE 3:
            IF which_object = 1 THEN
                attach_blue;
            ELSE
                attach_red;
            ENDIF
            actual_state := 4;
        CASE 4:
            SetDO DO_MOVER, 1;
            actual_state :=100;
        CASE 100:
        
        ENDTEST    
    ENDPROC
    PROC initial_position()
        PulseDO DO_POS_0;
        PulseDO DO_POS_B_1;
        PulseDO DO_POS_B_2;
        PulseDO DO_POS_A_1;
        PulseDO DO_POS_A_2;
        !PulseDO DO_POS_DR_1;
        !PulseDO DO_POS_DR_2;
        PulseDO DO_POS_BOX;
    ENDPROC
    PROC Path_1()
        MoveL Target_10,v300,z100,smc_gripper\WObj:=wobj0;
        MoveL Target_20_2,v300,z100,smc_gripper\WObj:=wobj0;   
        MoveL Target_20,v300,fine,smc_gripper\WObj:=wobj0;
        WaitTime 0.5;
        ! ATTACH
        PulseDO DO_ATT_0;
        WaitTime 0.5;
        MoveL Target_20_2_2,v300,z100,smc_gripper\WObj:=wobj0;
        MoveL Target_30_2,v300,z100,smc_gripper\WObj:=wobj0;
        MoveL Target_30,v300,fine,smc_gripper\WObj:=wobj0;
        WaitTime 0.5;
        ! DETACH
        PulseDO DO_DET_0;
        WaitTime 0.5;
        MoveL Target_10,v300,z100,smc_gripper\WObj:=wobj0;
    ENDPROC
    PROC Path_Blue_Objects()
        MoveL Target_40,v300,z100,smc_gripper\WObj:=Blue_Objects;
        MoveL Target_50_2,v300,z100,smc_gripper\WObj:=Blue_Objects;
        MoveL Target_50,v300,fine,smc_gripper\WObj:=Blue_Objects;
        WaitTime 0.5;
        ! ATTACH
        PulseDO DO_ATT_B_1;
        WaitTime 0.5;
        MoveL Target_50_2,v300,z100,smc_gripper\WObj:=Blue_Objects;
        MoveL Target_60_2,v300,z100,smc_gripper\WObj:=Blue_Objects;
        MoveL Target_60,v300,fine,smc_gripper\WObj:=Blue_Objects;
        WaitTime 0.5;
        ! DETACH
        PulseDO DO_DET_B_1;
        WaitTime 0.5;
        MoveL Target_60_2,v300,z100,smc_gripper\WObj:=Blue_Objects;
        MoveL Target_70_2,v300,z100,smc_gripper\WObj:=Blue_Objects;
        MoveL Target_70,v300,fine,smc_gripper\WObj:=Blue_Objects;
        WaitTime 0.5;
        ! ATTACH
        PulseDO DO_ATT_B_2;
        WaitTime 0.5;
        MoveL Target_70_2,v150,z100,smc_gripper\WObj:=Blue_Objects;
        MoveL Target_80_2,v150,z100,smc_gripper\WObj:=Blue_Objects;
        MoveL Target_80,v150,fine,smc_gripper\WObj:=Blue_Objects;
        WaitTime 0.5;
        ! DETACH
        PulseDO DO_DET_B_2;
        WaitTime 0.5;
        MoveL Target_40,v300,z100,smc_gripper\WObj:=Blue_Objects;
    ENDPROC
    PROC Path_Red_Objects()
        MoveL Target_90,v300,z100,smc_gripper\WObj:=Red_Objects;
        MoveL Target_100_2,v300,z100,smc_gripper\WObj:=Red_Objects;
        MoveL Target_100,v300,fine,smc_gripper\WObj:=Red_Objects;
        WaitTime 0.5;
        ! ATTACH
        PulseDO DO_ATT_R_1;
        WaitTime 0.5;
        MoveL Target_100_2,v300,z100,smc_gripper\WObj:=Red_Objects;
        MoveL Target_110_2,v300,z100,smc_gripper\WObj:=Red_Objects;
        MoveL Target_110,v300,fine,smc_gripper\WObj:=Red_Objects;
        WaitTime 0.5;
        ! DETACH
        PulseDO DO_DET_R_1;
        WaitTime 0.5;
        MoveL Target_110_2,v300,z100,smc_gripper\WObj:=Red_Objects;
        MoveL Target_120_2,v300,z100,smc_gripper\WObj:=Red_Objects;
        MoveL Target_120,v300,fine,smc_gripper\WObj:=Red_Objects;
        WaitTime 0.5;
        ! ATTACH
        PulseDO DO_ATT_R_2;
        WaitTime 0.5;
        MoveL Target_120_2,v150,z100,smc_gripper\WObj:=Red_Objects;
        MoveL Target_130_2,v150,z100,smc_gripper\WObj:=Red_Objects;
        MoveL Target_130,v150,fine,smc_gripper\WObj:=Red_Objects;
        WaitTime 0.5;
        ! DETACH
        PulseDO DO_DET_R_2;
        WaitTime 0.5;
        MoveL Target_90,v300,z100,smc_gripper\WObj:=Red_Objects;
    ENDPROC
    PROC Path_Dark_Red_Objects()
        MoveL Target_140,v300,z100,smc_gripper\WObj:=Dark_Red_Objects;
        MoveL Target_150_2,v300,z100,smc_gripper\WObj:=Dark_Red_Objects;
        MoveL Target_150,v300,fine,smc_gripper\WObj:=Dark_Red_Objects;
        WaitTime 0.5;
        ! ATTACH
        !PulseDO DO_ATT_DR_1;
        WaitTime 0.5;
        MoveL Target_150_2,v300,z100,smc_gripper\WObj:=Dark_Red_Objects;
        MoveL Target_160_2,v300,z100,smc_gripper\WObj:=Dark_Red_Objects;
        MoveL Target_160,v300,fine,smc_gripper\WObj:=Dark_Red_Objects;
        WaitTime 0.5;
        ! DETACH
        !PulseDO DO_DET_DR_1;
        WaitTime 0.5;
        MoveL Target_160_2,v300,z100,smc_gripper\WObj:=Dark_Red_Objects;
        MoveL Target_170_2,v300,z100,smc_gripper\WObj:=Dark_Red_Objects;
        MoveL Target_170,v300,fine,smc_gripper\WObj:=Dark_Red_Objects;
        WaitTime 0.5;
        ! ATTACH
        !PulseDO DO_ATT_DR_2;
        WaitTime 0.5;
        MoveL Target_170_2,v300,z100,smc_gripper\WObj:=Dark_Red_Objects;
        MoveL Target_180_2,v300,z100,smc_gripper\WObj:=Dark_Red_Objects;
        MoveL Target_180,v300,fine,smc_gripper\WObj:=Dark_Red_Objects;
        WaitTime 0.5;
        ! DETACH
        !PulseDO DO_DET_DR_2;
        WaitTime 0.5;
        MoveL Target_140,v300,z100,smc_gripper\WObj:=Dark_Red_Objects;
    ENDPROC
    PROC attach_blue()
        PulseDO DO_ATT_B_1_TO_O;
        PulseDO DO_ATT_B_2_TO_O;
    ENDPROC
    PROC attach_red()
        PulseDO DO_ATT_R_1_TO_O;
        PulseDO DO_ATT_R_2_TO_O;
    ENDPROC
    PROC attach_dark_red()
        !PulseDO DO_ATT_DR_1_TO_O;
        !PulseDO DO_ATT_DR_2_TO_O;
    ENDPROC
ENDMODULE